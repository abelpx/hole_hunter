package services

import (
	"github.com/holehunter/holehunter/internal/models"
	"github.com/holehunter/holehunter/internal/repository"
)

type VulnerabilityService struct {
	repo *repository.VulnerabilityRepository
}

func NewVulnerabilityService(repo *repository.VulnerabilityRepository) *VulnerabilityService {
	return &VulnerabilityService{repo: repo}
}

func (s *VulnerabilityService) GetAll() ([]models.Vulnerability, error) {
	return s.repo.GetAll()
}

func (s *VulnerabilityService) GetByTaskID(taskID int) ([]models.Vulnerability, error) {
	return s.repo.GetByTaskID(taskID)
}

func (s *VulnerabilityService) Create(taskID int, templateID, severity, name, description, url, matchedAt, cve string, cvss float64) (*models.Vulnerability, error) {
	return s.repo.Create(taskID, templateID, severity, name, description, url, matchedAt, cve, cvss)
}

func (s *VulnerabilityService) Update(id int, falsePositive bool, notes string) error {
	return s.repo.Update(id, falsePositive, notes)
}

func (s *VulnerabilityService) Delete(id int) error {
	return s.repo.Delete(id)
}
